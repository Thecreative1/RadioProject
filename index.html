<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Webamp com Visualizações</title>
  <script src="js/butterchurn.js"></script>
  <script src="js/butterchurnPresets.js"></script>
  <script src="js/webamp-butterchurn.min.js"></script>
  <script src="https://unpkg.com/webamp"></script>
  <style>
    body {
      margin: 0;
      background-color: black;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      height: 100vh;
    }
    #winamp {
      margin-top: 20px;
    }
    #visualizer {
      width: 640px;
      height: 480px;
      margin-top: 10px;
      background-color: black;
      border: 2px solid #333;
    }
  </style>
</head>
<body>
  <div id="winamp"></div>
  <canvas id="visualizer" width="640" height="480"></canvas>

  <script>
    const visualizerCanvas = document.getElementById("visualizer");

    const webamp = new Webamp({
      initialTracks: [
        {
          metaData: { artist: "RFM", title: "RFM ao Vivo" },
          url: "https://21223.live.streamtheworld.com/RFMAAC.aac",
          duration: 0
        },
        {
          metaData: { artist: "Comercial", title: "Comercial ao Vivo" },
          url: "https://mcrscast.mcr.iol.pt/comercial.mp3",
          duration: 0
        }
      ],
      initialSkin: {
        url: "milkyway.wsz"
      },
      filePickers: []
    });

    webamp.renderWhenReady(document.getElementById("winamp")).then(() => {
      const visualizer = window.butterchurn.createVisualizer(
        webamp.getAudioContext(),
        visualizerCanvas,
        { width: 640, height: 480 }
      );

      visualizer.connectAudio(webamp.getAudioNode());

      const presets = window.butterchurnPresets.getPresets();
      const preset = presets["Flexi, martin + geiss - dedicated to the sherwin maxawow"];
      visualizer.loadPreset(preset, 0.0);
    });
  </script>
</body>
</html>
